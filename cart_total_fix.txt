The issue is that the cart summary total calculation doesn't match the checkout total calculation.

In CheckoutController (line 165-170):
```php
$netSubtotal = max(0, $subtotal - $discountAmount);
$vatPercent = \App\Models\ShippingSetting::first()?->vat_percent ?? 0.05;
$vatBase = $netSubtotal + $shipping['total'] + $installationFees;
$vat = round($vatBase * $vatPercent, 2);
$total = $vatBase + $vat;
```

But in CartService generateCartSummary (line 120-125):
```php
$totalBeforeDiscount = $subtotal + $shippingCost + $installationFee + $vat;
$total = max(0, $totalBeforeDiscount - $discount);
```

The VAT calculation is different. In checkout, VAT is calculated on the net amount AFTER discount, but in cart summary, VAT is calculated BEFORE discount is applied.

Fix: Update CartService to match checkout calculation:

Replace lines 120-125 in CartService with:
```php
// Apply discount first, then calculate VAT on the net amount
$netSubtotal = max(0, $subtotal - $discount);
$vatBase = $netSubtotal + $shippingCost + $installationFee;
$vat = round($vatBase * $vatPercent, 2);
$total = $vatBase + $vat;
```

This will ensure the cart summary total matches the checkout total that gets sent to Paymob.